
核心速览

本文提出了一种高效的医学图像分割解码器EMCAD，通过多尺度深度卷积和门控注意力机制显著提升了计算效率与分割精度。

研究背景
• 研究问题：
    a. 医学图像分割解码器存在高计算成本问题，限制了在资源受限场景的应用
    b. 现有注意力机制模型虽然性能提升，但伴随昂贵的卷积计算开销
    c. 视觉Transformer在捕获长程依赖时，对局部空间上下文的理解不足
• 研究难点：
    d. 如何在保持精度的同时大幅降低参数量和计算量（FLOPs）
    e. 平衡全局信息捕获与局部空间细节保留的矛盾
    f. 设计轻量化的多尺度特征融合机制
    g. 实现模型对不同编码器的通用适配性
• 文献综述：
    h. 经典CNN架构：AlexNet/VGG的深层卷积、GoogleNet的多尺度模块、ResNet的残差连接、MobileNet的深度可分离卷积
    i. U型网络发展：UNet（基础架构）、UNet++（嵌套稠密连接）、UNet3+（全尺度跳跃连接）、nnU-Net（自动化设计）
    j. 视觉Transformer：Swin Transformer（滑动窗口注意力）、PVT系列（空间缩减注意力）、MaxViT（多轴注意力）
    k. 混合方法：ConvFormer（CNN-Transformer混合）、MetaFormer（通用架构框架）
    l. 医学分割挑战：多模态数据（内窥镜/MRI/CT）、小目标分割、器官/病变的形态多样性
高效多尺度卷积注意力解码器（EMCAD）
• 多尺度深度卷积块：EMCAD采用多尺度深度卷积块（MSCB）来增强特征图，通过并行执行不同核大小（1×1、3×3、5×5）的深度卷积（DWCB）捕获多尺度信息。每个DWCB包含深度卷积、批归一化和ReLU6激活，并通过通道混洗（CS）增强通道间交互。计算过程如式4所示：MSCB(x) = BN(PWC2(CS(MSDC(R6(BN(PWC1(x)))))))，其中MSDC通过式5实现多尺度卷积的并行融合。
• 门控注意力机制：设计了通道注意力块（CAB）和空间注意力块（SAB）分别优化特征通道和空间位置。CAB通过最大/平均池化生成通道权重（式7），SAB则使用7×7大核卷积强化局部上下文（式8）。此外，引入大核分组注意力门（LGAG），通过3×3分组卷积替代传统1×1卷积，以更低计算成本（仅0.381G FLOPs）捕获更大局部上下文（式1-2）。
• 高效上采样模块：采用深度卷积的EUCB模块（式9）进行上采样，相比标准3×3卷积减少计算量。模块依次包含双线性插值上采样、3×3深度卷积、批归一化、ReLU激活和1×1卷积，最终输出与跳连特征分辨率匹配。
整体架构设计
• 编码器适配性：EMCAD兼容PVTv2等分层视觉编码器，实验中使用PVTv2-B0（Tiny）和PVTv2-B2（Standard）作为编码器，分别构建PVT-EMCAD-B0（0.507M参数）和PVT-EMCAD-B2（1.91M参数）架构。编码器输出四阶段特征（X1-X4），经MSCAM模块逐级细化后，通过LGAG与跳连特征融合（图2）。
• 多阶段损失聚合：采用组合损失策略（式11），对四个解码器阶段输出的分割图（p1-p4）计算加权损失（α=β=γ=ζ=δ=1.0），并增加p1+p2+p3+p4的联合损失项。多类分割采用MERIT的MUTATION方法，组合15种预测的损失求和优化。
实验验证
• 数据集与指标：在12个医学图像数据集（涵盖息肉、皮肤病变、细胞、乳腺癌等6类任务）上测试，包括ClinicDB、ISIC17、Synapse多器官等。评估指标采用DICE系数、HD95距离和mIoU，输入分辨率分为256×256（BUSI）、352×352（息肉）和224×224（Synapse）。
• 性能对比：PVT-EMCAD-B2在息肉分割中DICE达95.21%（ClinicDB），较PolypPVT提升1.08%；在Synapse多器官分割中平均DICE为83.63%，超越PVT-CASCADE 0.85%，参数量减少79.4%（1.91M vs 9.27M）。PVT-EMCAD-B0在皮肤病变（ISIC17 DICE 85.67%）和乳腺癌（BUSI DICE 79.80%）任务中表现优异，仅需0.84G FLOPs（表1-3）。
• 计算效率：相比基线CASCADE解码器，EMCAD在PVTv2-B2上减少80.3% FLOPs（0.381G vs 1.93G），PVTv2-B0上减少74.9% FLOPs（0.110G vs 0.439G），同时DICE提升1.43%（表6）。
消融研究
• 组件有效性：逐步添加级联结构、LGAG和MSCAM模块，Synapse数据集DICE从80.10%提升至83.63%。MSCAM贡献最大（+1.78%），LGAG次之（+0.84%）（表4）。
• 多尺度核配置：测试[1,3,5,7,9]等核组合，[1,3,5]在ClinicDB和Synapse上表现最优（DICE 95.21%和83.63%），更大核导致性能下降（表5）。
• 并行与串行MSDC：并行多尺度卷积（式5）比串行（式6）快20%，且DICE提高0.5%，因其独立处理各尺度特征。
总体结论
• 高效性突破：EMCAD通过深度卷积和多尺度注意力机制，在12个数据集上实现SOTA性能，参数量（1.91M）和FLOPs（0.381G）分别降低79.4%和80.3%，尤其适合计算资源受限场景（图1,3）。
• 架构创新：提出的MSCAM和LGAG模块显著提升局部上下文捕获能力，其中[1,3,5]多尺度卷积组合最优，验证了多尺度深度卷积在医学分割中的有效性。
• 广泛适用性：兼容PVTv2等多种编码器，在息肉、器官分割等任务中DICE最高提升2.36%（ETIS数据集），为轻量化医学图像分析提供新范式。代码已开源（GitHub/SLDGroup/EMCAD）。

EMCAD（高效多尺度卷积注意力解码器）的核心组件由以下模块构成：
多尺度卷积注意力模块（MSCAM）
包含多尺度深度卷积块（MSDC）、通道注意力块（CAB）和空间注意力块（SAB）
采用并行多尺度深度卷积（kernel size为1×1、3×3、5×5）提取多分辨率特征，通过通道重排增强跨组信息交互
通道注意力通过全局最大/平均池化动态调整通道重要性，空间注意力使用7×7大核卷积聚焦关键区域
大核组注意力门（LGAG）
采用3×3分组卷积处理跳跃连接特征和上采样特征，替代传统点卷积
通过Sigmoid生成空间注意力系数，在扩大局部感受野的同时减少计算量
高效上卷积块（EUCB）
由双线性上采样、3×3深度卷积和1×1卷积组成
通过深度卷积替代标准卷积，显著降低FLOPs
分割头（SH）
每个解码阶段配备1×1卷积层生成分割图
支持多阶段损失聚合策略，通过组合损失优化模型
多阶段特征融合架构
四阶段级联结构处理金字塔特征（X1-X4）
通过渐进式上采样和跨阶段注意力门实现多分辨率特征融合
这些组件通过参数共享和轻量化设计，使EMCAD在标准编码器下仅需1.91M参数和0.381G FLOPs，相比同类方法减少79.4%参数和80.3%计算量，同时达到12个医学图像分割数据集的最优性能。

EMCAD采用三种创新注意力机制，通过多维度特征聚焦实现高效医学图像分割：

通道-空间组合注意力

通道注意力块（CAB）：通过双路全局池化（最大/平均）捕获通道统计特征，采用压缩比为1/16的瓶颈结构动态调整通道权重，增强重要特征通道的表达
空间注意力块（SAB）：沿通道维度聚合最大/平均值，使用7×7大核卷积生成空间权重图，精准定位病灶区域
大核分组注意力门（LGAG）
采用3×3分组卷积处理跳跃连接和上采样特征
通过Sigmoid生成空间注意力系数，在扩大局部感受野（9x9有效区域）的同时减少71%计算量
多尺度深度卷积注意力
并行实施1×1/3×3/5×5深度卷积，捕获跨尺度特征
通过通道重排(shuffle)增强跨组特征交互，提升细粒度特征表达能力
实验表明，这些机制组合使模型在Synapse多器官分割任务中DICE提升3.53%，同时参数量减少79.4%。其中大核注意力门贡献了0.71%性能增益，而多尺度卷积带来1.65%提升。