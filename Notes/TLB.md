

# 《基于低分辨率无人机遥感图像的茶叶叶斑病检测》论文详解

## 一、研究背景与问题

茶叶叶斑病(TLB)是中国茶树主要病害之一，影响茶叶质量和产量。传统TLB检测依赖人工观察，存在主观性强、效率低、准确率差等问题。现有基于无人机(UAV)的TLB检测方法主要使用高分辨率图像，但实际应用中UAV飞行高度较高(12-14米)，导致图像分辨率低，TLB病斑小、边缘模糊、背景复杂，现有检测方法效果不佳。

## 二、数据集

### 1. 数据采集
- **地点**：中国安徽省合肥市包拯镇茶园（西南部，西邻芜湖市，北临巢湖）
- **设备**：配备4800万像素可见光传感器的无人机
- **图像类型**：
  - **高分辨率(HR)图像**：128张（飞行高度2-4米），用于训练RFBDB-GAN和LWDNet
  - **低分辨率(LR)图像**：16张（飞行高度12-14米），用于验证/测试

### 2. 数据预处理
- **HR图像处理**：通过滑动窗口从原始8000×6000图像中生成100张800×600图像，共得到996张高分辨率训练图像
- **LR图像处理**：直接用于测试
- **数据增强**：
  - LWDNet使用马赛克增强、翻转、颜色抖动和噪声添加
  - 通过这些增强，训练集从996张扩展到3930张

## 三、算法原理

### 1. 两阶段检测框架

该研究提出一个两阶段网络框架，包括：
1. **RFBDB-GAN超分辨率网络**：恢复LR图像细节
2. **LWDNet检测网络**：进行TLB精确检测

![检测流程图](https://i.imgur.com/5601218.png)

### 2. RFBDB-GAN超分辨率网络

#### (1) 网络结构
- **生成器**：使用RFB密集残差块(RFBDB)结构，由8个RFBDB块组成
- **判别器**：使用带谱归一化(SN)的UNet结构

#### (2) RFB密集残差块(RFBDB)
RFBDB模块的改进结构如图8(b)所示：
- 与常规残差块不同，RFBDB模块的每一层输出连接到后续输入层
- 促进信息交换，避免冗余特征学习
- 为避免过拟合，移除了RFB中的所有批归一化(BN)层
- 使用LeakyReLU代替ReLU激活函数



#### (3) 多尺度两阶段退化方法
传统退化模型无法有效模拟不同UAV拍摄高度引起的退化：
```
x = D(y) = [(y ⊗ k) ↓s + n]_JPEG
```
本文提出的多尺度两阶段退化方法：
```
x = D2(y) = (D2 ◦ D1)(y)
```
- **D1**：多尺度下采样（随机缩放因子代替下采样因子）
- **D2**：应用两种经典退化操作（模糊+噪声+JPEG压缩）

#### (4) 损失函数
RFBDB-GAN的损失函数：
```
L_G = L_percep + λ L_{RaG} + η L_1
```
其中：
- `L_1 = E_{x_i} ||G(x_i) - y||_1`：1范数距离
- `L_percep`：感知损失
- `L_{RaG} = -E_{x_r}[log(1 - D_{Ra}(x_r, x_f))] - E_{x_f}[log D_{Ra}(x_f, x_r)]`：GAN损失
- `λ = 0.1, η = 1`

#### (5) 谱归一化(SN)
用于判别器，确保判别器满足Lipschitz连续性：
- 将权重矩阵进行SVD分解
- 限制最大奇异值为1
- 除以最大奇异值，将权重矩阵归一化

### 3. LWDNet检测网络

#### (1) 网络结构
LWDNet由三部分组成：
- **特征提取**：使用SNet_A和SNet_B模块
- **特征融合**：使用ELPNet结构
- **检测部分**：使用SIoU损失函数



#### (2) SNet特征提取
- **SNet_A**：输出通道数是输入通道数的两倍，特征图大小是输入的一半
- **SNet_B**：输出通道数与输入一致，特征图大小与输入一致
- 5×5 DWConv代替ShuffleNetV2中的3×3 DWConv
- 使用LeakyReLU代替ReLU激活函数

#### (3) ELPNet特征融合
- 结合浅层、中层和深层特征
- **底部向上**：两次上采样，连接浅层和中层特征
- **顶部向下**：分别融合中层和深层特征
- 为减少参数，仅在顶部向下过程中使用DWConv

#### (4) SIoU损失函数
SIoU损失函数定义为：
```
Loss_SIoU = 1 - IoU + 1 + 2
```
其中：
- `1`：距离损失
- `2`：形状损失

**形状损失**：
```
= ∑_{t=w,h} (1 - e^{-w_t})^θ
w_w = |w - w_gt| / max(w, w_gt)
w_h = |h - h_gt| / max(h, h_gt)
```
其中`(w, h)`和`(w_gt, h_gt)`分别表示预测框和真实框的宽度和高度，`θ`控制对形状损失的关注程度。

**角度损失**：
```
3 = 1 - 2 * sin^2(arcsin(c/σ_h) - π/4)
c = sin(α)
σ = √((b_cx_t - b_cx)^2 + (b_cy_t - b_cy)^2)
c_h = max(b_gt_cy, b_cy) - min(b_gt_cy, b_cy)
```

**距离损失**：
```
1 = ∑_{t=x,y} (1 - e^{-γ p_t})
p_x = (b_cx_t - b_cx / c_w)^2
p_y = (b_cy_t - b_cy / c_h)^2
γ = 2 - 3
```

## 四、实验结果

### 1. 超分辨率性能
- RFBDB-GAN在PSNR、SSIM等指标上优于其他SR方法
- 与ESRGAN相比，RFBDB-GAN生成的图像边缘信息更丰富，茶叶边缘细节更明显
- 与传统单阶段退化方法相比，多尺度两阶段退化方法效果更好
- 谱归一化(SN)的加入使网络恢复细节能力更强

### 2. 检测性能
- LWDNet模型大小为716 kB，仅为YOLOv5s(14.4 MB)的5%
- 与现有方法相比，LWDNet在低分辨率UAV图像上检测TLB的准确率更高
- 与YOLOv5s相比，LWDNet的mAP仅低0.01，但模型大小小得多
- 与YOLOv7-tiny等轻量级网络相比，LWDNet的精度更高，参数更少

### 3. 消融实验
- SIoU损失函数相比其他损失函数，能显著提高精度、召回率、mAP和F1
- 数据增强使检测精度显著提高
- SNet特征提取结构相比ShuffleNetV2，参数更少且精度波动小
- ELPNet特征融合结构能显著减少网络参数，同时提高检测精度

## 五、结论

该研究提出了一种有效的、低成本的从低分辨率UAV遥感图像中检测茶叶叶斑病的方法：

1. 通过RFBDB-GAN超分辨率网络恢复低分辨率图像细节，解决了UAV飞行高度高导致的图像模糊问题
2. 通过LWDNet轻量级检测网络实现高效准确的TLB检测，模型大小仅为YOLOv5s的5%
3. 提出的多尺度两阶段退化方法有效解决了训练数据不足的问题
4. 实验证明，该方法显著提高了低分辨率UAV图像中TLB的检测精度

该方法为茶园病害监测提供了一种高效、低成本的解决方案，特别适用于大面积茶园的实时监测。
